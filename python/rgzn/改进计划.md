# 项目改进计划

## 当前状态分析

项目已经有了基本的框架：
- ✅ Provider 管理基础
- ✅ TTS 基础功能
- ✅ 异步任务队列
- ✅ CLI 交互模式

## 需要改进的功能

### 1. Provider 管理增强
- ✅ 支持少量可用 provider 的轮换逻辑
- ✅ 自动轮换失败 provider
- ✅ 记录每个 provider 的带宽/Token 使用
- ⚠️ 需要完善弱网模式的恢复机制
- ⚠️ 需要更好的 provider 健康检查

### 2. TTS 管理增强
- ✅ 异步生成语音
- ✅ 支持流式播放
- ✅ 可选自动播放
- ✅ 生成语音后程序不退出
- ✅ 支持 `tts:` 命令
- ⚠️ 流式播放需要优化（pygame 依赖）

### 3. CLI 交互
- ✅ 单次 prompt 模式
- ✅ 交互模式
- ✅ 输入为空时提示
- ✅ exit 安全退出

### 4. 日志和调试
- ✅ verbose 模式
- ⚠️ 需要更详细的异常日志

### 5. 异步任务调度
- ✅ chat 与 TTS 统一队列
- ✅ 失败任务重试
- ✅ 延迟任务支持
- ⚠️ 需要优化网络恢复后的任务处理

## 改进方案

### Phase 1: 修复和优化现有功能
1. 修复 TTS 流式播放的参数问题
2. 优化弱网模式的恢复逻辑
3. 增强错误处理和日志

### Phase 2: 增强功能
1. 添加 provider 健康监控
2. 优化带宽管理策略
3. 改进任务重试机制

### Phase 3: 测试和文档
1. 编写测试脚本
2. 完善使用文档
3. 添加示例配置
